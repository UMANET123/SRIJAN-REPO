# Two Factor Authentication

## Index
- [Introduction](#introduction)
- [Dependencies](#dependencies)
- [Handlers](#handlers)
- [Implementation Details](#implementation-details)

### Introduction

A Microservice to provide Two Factor Authentication for Globe Telecom numbers.
This service expects a `address` ( Mobile Number ) that belongs to the Philippines, and will generate an OTP (Numerical) which is sent over Email/SMS to the registered user.

The OTP has a 30 second Window after which it will expire

### Dependencies

- Express
- Body Parser
- OTLIB

### Handlers

- Generate

Generates an OTP based on the number provided

Note: Make sure the number is from the Philippines

Url
```http
POST /generate
```

Request
```javascript
{
    "address" : "639234567891", // Mobile number
}
```

Response 200
```javascript
{
    "address" : "639234567891", // Mobile Number
    "otp": "1234" // OTP generated
}
```

Response 400
```javascript
{
    "error": "Mobile Number Invalid, does not belong to the Philippines"
}
```

- Verify

Verifies an OTP which was generated from the step above

URL
```http
    POST /verify
```

Request
```javascript
{
    "address": "639234567891", // Mobile Number
    "otp": "1234" // OTP to verify
}
```

Response 200
```javascript
{
    "address": "639234567891", // Mobile Number
    "otp": "1234", // OTP that was verified
    "verified": true // Verification status
}
```
Response 400
```javascript
{
    "error": "The OTP has expired, please request for a new one"
}
```


NOTE:
Please note that , if number (address) provided is not from the Philippines, the response will be 400

## Implementation Details
A Secret is generated by calling 

```javascript
const secret = optlib.authenticator.generateSecret();
```

And to generate an OTP, we append the `address` with the `secret`, to verify also, we append the `address` with the `secret`

The OTP is short lived, only for `30s` ( seconds )